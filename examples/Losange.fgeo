<?xml  version="1.0" encoding="UTF-8" ?><drgenius><drgeo axes="False" custom_controls="True" grid="True" gridded="True" name="Losange" origin_x="-26.974999999999994" origin_y="16.599999999999994" scale="8.0"><controls wheelX="True" wheelY="True" wheelZ="True"/> <point color="Red" delta="(7@7)" feedback="True" id="1025273581" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-20</x><y>5</y></point><point color="Red" delta="(7@7)" feedback="True" id="941892412" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-15</x><y>15</y></point><point color="Red" delta="(7@7)" feedback="True" id="944562697" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-35</x><y>20</y></point><point color="Red" delta="(7@7)" feedback="True" id="1070070084" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-35</x><y>-5</y></point><polygon anchor="0.317" arrow="makeNoArrows" color="Red" delta="(-50.57626844763132@10.661333297548907)" feedback="True" fill="True" id="125820315" masked="False" name="" style="plain" thickness="small" translucent="True" type="npts"><parent ref="1025273581"/> <parent ref="941892412"/> <parent ref="944562697"/> <parent ref="1070070084"/> </polygon><value background="Brown" class="DrGeoScriptRhombus" color="Black" delta="(7@7)" feedback="True" fontSize="14" id="34092099" locked="False" masked="False" name="" type="script"><parent ref="125820315"/> <code>DrGeoUserScript subclass: #DrGeoScriptRhombus&#13;&#9;instanceVariableNames: ''&#13;&#9;classVariableNames: ''&#13;&#9;poolDictionaries: ''&#13;&#9;category: 'DrGeoII-User'!&#13;&#13;!DrGeoScriptRhombus methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:55'!&#13;paintRed&#13;&#9;self costume1 style color: Color red! !&#13;&#13;!DrGeoScriptRhombus methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 22:03'!&#13;compute&#13;&#9;self paintRed.&#13;&#9;^ self isRhombus&#13;&#9;&#9;ifTrue: [ &#13;&#9;&#9;&#9;self paintBlue.&#13;&#9;&#9;&#9;'Bravo !! Je suis un losange.' ]&#13;&#9;&#9;ifFalse: [  | message |&#13;&#9;&#9;&#9;message := ReadWriteStream on: String new.&#13;&#9;&#9;&#9;message &lt;&lt; 'Voyons, je ne suis pas un losange car :'.&#13;&#9;&#9;&#9;self isQuad &#13;&#9;&#9;&#9;&#9;ifFalse: [ message crtab &lt;&lt; '- je n''ai pas 4 sommets']&#13;&#9;&#9;&#9;&#9;ifTrue: [ &#13;&#9;&#9;&#9;&#9;&#9;self isIsometric ifFalse: [message crtab &lt;&lt; '- mes côtés ne sont pas isométriques'].&#13;&#9;&#9;&#9;&#9;&#9;self isOppositeSideParallel ifFalse: [ message crtab &lt;&lt; '- mes côtés opposés ne sont pas parallèles' ]].&#13;&#9;&#9;&#9;&#9;message contents]&#13;! !&#13;&#13;!DrGeoScriptRhombus methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:55'!&#13;isQuad&#13;&#9;^ self arg1 points size = 4! !&#13;&#13;!DrGeoScriptRhombus methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:57'!&#13;isIsometric&#13;&#9;| side1 |&#13;&#9;side1 := self arg1 sidesLength first.&#13;&#9;^ self arg1 sidesLength&#13;&#9;&#9;detect: [ :aSide| (aSide closeTo: side1) not ]&#13;&#9;&#9;ifFound: [ false ]&#13;&#9;&#9;ifNone: [ true ]! !&#13;&#13;!DrGeoScriptRhombus methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:55'!&#13;isOppositeSideParallel&#13;&#9;| side1 side2 side3 side4 points|&#13;&#9;points := self arg1 points.&#13;&#9;side1 := points first - points second.&#13;&#9;side2 := points second - points third.&#13;&#9;side3 := points third - points fourth.&#13;&#9;side4 := points fourth - points first.&#13;&#13;&#9;^ ((side1 crossProduct: side3) closeTo: 0)  and: [(side2 crossProduct: side4) closeTo: 0]  &#13;! !&#13;&#13;!DrGeoScriptRhombus methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:56'!&#13;isRhombus&#13;&#9;|   points mid1 mid2 diag1 diag2 |&#13;&#9;points := self arg1 points.&#13;&#9;diag1 := points first - points third.&#13;&#9;diag2 := points second - points fourth.&#13;&#9;mid1 := points first + points third / 2.&#13;&#9;mid2 := points second + points fourth / 2.&#13;&#9;^ self isQuad and: [mid1 = mid2 and: [(diag1 dotProduct: diag2) closeTo: 0]]&#13;! !&#13;&#13;!DrGeoScriptRhombus methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:55'!&#13;paintBlue&#13;&#9;self costume1 style color: Color blue! !&#13;&#13;&quot;-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- &quot;!&#13;&#13;DrGeoScriptRhombus class&#13;&#9;instanceVariableNames: ''!&#13;&#13;!DrGeoScriptRhombus class methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:58'!&#13;description&#13;&#9;^'Je vérifie si un quadrilatère est un losange.&#13;Pour m''utiliser :&#13;1. Clique sur un polygone ;&#13;2. Clique quelque part sur le fond de la figure.&#13;Je colorie en bleu le quadrilatère lorsque c''est un losange, sinon j''indique ce qui ne va pas.'! !&#13;&#13;!DrGeoScriptRhombus class methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:58'!&#13;scriptName&#13;&#9;^'Est losange ?'! !&#13;&#13;&#13;!DrGeoScriptRhombus class methodsFor: 'private' stamp: 'DrGeoUser 5/22/2015 21:55'!&#13;newArgumentsType&#13;&#9;^{DrGPolygonItem}! !&#13;</code><x>-53.425000000000026</x><y>36.050000000000026</y></value></drgeo></drgenius>