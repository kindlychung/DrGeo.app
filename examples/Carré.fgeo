<?xml  version="1.0" encoding="UTF-8" ?><drgenius><drgeo axes="False" custom_controls="True" grid="True" gridded="True" name="Carré" origin_x="-26.974999999999994" origin_y="16.599999999999994" scale="8.0"><controls wheelX="True" wheelY="True" wheelZ="True"/> <point color="Red" delta="(7@7)" feedback="True" id="938760926" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-25</x><y>-5</y></point><point color="Red" delta="(7@7)" feedback="True" id="1033703598" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-20</x><y>10</y></point><point color="Red" delta="(7@7)" feedback="True" id="969138248" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-35</x><y>15</y></point><point color="Red" delta="(7@7)" feedback="True" id="907811243" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-45</x><y>0</y></point><polygon anchor="0.14709435895068923" arrow="makeNoArrows" color="Red" delta="(-69.21052350276636@ -18.708666702450955)" feedback="True" fill="True" id="246729262" masked="False" name="" style="plain" thickness="small" translucent="True" type="npts"><parent ref="938760926"/> <parent ref="1033703598"/> <parent ref="969138248"/> <parent ref="907811243"/> </polygon><value background="Black" class="DrGeoScriptSquare" color="Blue" delta="(7@7)" feedback="True" fontSize="14" id="271560394" locked="False" masked="False" name="" type="script"><parent ref="246729262"/> <code>DrGeoUserScript subclass: #DrGeoScriptSquare&#13;&#9;instanceVariableNames: ''&#13;&#9;classVariableNames: ''&#13;&#9;poolDictionaries: ''&#13;&#9;category: 'DrGeoII-User'!&#13;&#13;!DrGeoScriptSquare methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:38'!&#13;isRectangleAngle&#13;&#9;| summits sides |&#13;&#9;summits := self arg1 points.&#13;&#9;sides := summits withIndexCollect: [:p :i | p - (summits at: i + 1 ifAbsent: [summits first])].&#13;&#9;sides withIndexDo: [ :s :i |&#13;&#9;&#9;((s dotProduct: (sides at: i + 1 ifAbsent: [sides first])) closeTo: 0) &#13;&#9;&#9;&#9;ifFalse: [ ^ false]].&#13;&#9;^ true! !&#13;&#13;!DrGeoScriptSquare methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 22:01'!&#13;compute&#13;&#9;self paintRed.&#13;&#9;^ self isSquare &#13;&#9;&#9;ifTrue:  [ &#13;&#9;&#9;&#9;self paintBlue.&#13;&#9;&#9;&#9;'Bravo !! Je suis un carré.' ]&#13;&#9;&#9;ifFalse: [ | message |&#13;&#9;&#9;&#9;message := ReadWriteStream on: String new.&#13;&#9;&#9;&#9;message &lt;&lt; 'Voyons, je ne suis pas un carré car :'.&#13;&#9;&#9;&#9;self isQuad &#13;&#9;&#9;&#9;&#9;ifFalse: [ message crtab &lt;&lt; '- je n''ai pas 4 sommets']&#13;&#9;&#9;&#9;&#9;ifTrue: [&#13;&#9;&#9;&#9;&#9;&#9;self isIsometric ifFalse: [message crtab &lt;&lt; '- mes côtés ne sont pas isométriques'].&#13;&#9;&#9;&#9;&#9;&#9;self isRectangleAngle ifFalse: [message crtab &lt;&lt; '- mes sommets ne sont pas droits']].&#13;&#9;&#9;&#9;message contents].&#13;&#9; ! !&#13;&#13;!DrGeoScriptSquare methodsFor: 'public' stamp: 'DrGeoUser 1/28/2015 12:15'!&#13;isQuad&#13;&#9;^ self arg1 points size = 4! !&#13;&#13;!DrGeoScriptSquare methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:28'!&#13;isSquare&#13;&#9;| diag1 diag2 points mid1 mid2 |&#13;&#9;points := self arg1 points.&#13;&#9;diag1 := points first - points third.&#13;&#9;mid1 := points first + points third / 2.&#13;&#9;diag2 := points second - points fourth.&#13;&#9;mid2 := points second + points fourth / 2.&#13;&#9;^ self isQuad and: [(diag1 r closeTo: diag2 r)  and: [(mid1 closeTo: mid2) and: [(diag1 dotProduct: diag2) closeTo: 0]]]&#13;! !&#13;&#13;!DrGeoScriptSquare methodsFor: 'public' stamp: 'DrGeoUser 1/28/2015 12:02'!&#13;isIsometric&#13;&#9;| side1 |&#13;&#9;side1 := self arg1 sidesLength first.&#13;&#9;^ self arg1 sidesLength&#13;&#9;&#9;detect: [ :aSide| (aSide closeTo: side1) not ]&#13;&#9;&#9;ifFound: [ false ]&#13;&#9;&#9;ifNone: [ true ]! !&#13;&#13;!DrGeoScriptSquare methodsFor: 'public' stamp: 'DrGeoUser 1/28/2015 12:13'!&#13;paintRed&#13;&#9;self costume1 style color: Color red! !&#13;&#13;!DrGeoScriptSquare methodsFor: 'public' stamp: 'DrGeoUser 1/28/2015 12:13'!&#13;paintBlue&#13;&#9;self costume1 style color: Color blue! !&#13;&#13;&quot;-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- &quot;!&#13;&#13;DrGeoScriptSquare class&#13;&#9;instanceVariableNames: ''!&#13;&#13;!DrGeoScriptSquare class methodsFor: 'public' stamp: 'DrGeoUser 1/28/2015 11:56'!&#13;description&#13;&#9;^'Je vérifie si un quadrilatère est un carré.&#13;Pour m''utiliser :&#13;1. Clique sur un polygone ;&#13;2. Clique quelque part sur le fond de la figure.&#13;Je colorie en bleu le quadrilatère lorsque c''est un carré, sinon j''indique ce qui ne va pas.'! !&#13;&#13;!DrGeoScriptSquare class methodsFor: 'public' stamp: 'DrGeoUser 1/28/2015 11:56'!&#13;scriptName&#13;&#9;^'Est carré ?'! !&#13;&#13;&#13;!DrGeoScriptSquare class methodsFor: 'private' stamp: 'DrGeoUser 1/28/2015 11:56'!&#13;newArgumentsType&#13;&#9;^{DrGPolygonItem}! !&#13;</code><x>-56.933333333333344</x><y>28.90416666666667</y></value></drgeo></drgenius>