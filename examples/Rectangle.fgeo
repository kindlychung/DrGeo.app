<?xml  version="1.0" encoding="UTF-8" ?><drgenius><drgeo axes="False" custom_controls="True" grid="True" gridded="True" name="Rectangle" origin_x="-26.974999999999994" origin_y="16.599999999999994" scale="8.0"><controls wheelX="True" wheelY="True" wheelZ="True"/> <point color="Red" delta="(7@7)" feedback="True" id="848522540" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-20</x><y>0</y></point><point color="Red" delta="(7@7)" feedback="True" id="941892412" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-15</x><y>15</y></point><point color="Red" delta="(7@7)" feedback="True" id="1034235835" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-40</x><y>15</y></point><point color="Red" delta="(7@7)" feedback="True" id="1070070084" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free"><x>-35</x><y>-5</y></point><polygon anchor="0.317" arrow="makeNoArrows" color="Red" delta="(-50.57626844763132@10.661333297548907)" feedback="True" fill="True" id="171883178" masked="False" name="" style="plain" thickness="small" translucent="True" type="npts"><parent ref="848522540"/> <parent ref="941892412"/> <parent ref="1034235835"/> <parent ref="1070070084"/> </polygon><value background="Green" class="DrGeoScriptRectangle" color="Black" delta="(7@7)" feedback="True" fontSize="14" id="896794686" locked="False" masked="False" name="" type="script"><parent ref="171883178"/> <code>DrGeoUserScript subclass: #DrGeoScriptRectangle&#13;&#9;instanceVariableNames: ''&#13;&#9;classVariableNames: ''&#13;&#9;poolDictionaries: ''&#13;&#9;category: 'DrGeoII-User'!&#13;&#13;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:39'!&#13;isRectangleAngle&#13;&#9;| summits sides |&#13;&#9;summits := self arg1 points.&#13;&#9;sides := summits withIndexCollect: [:p :i | p - (summits at: i + 1 ifAbsent: [summits first])].&#13;&#9;sides withIndexDo: [ :s :i |&#13;&#9;&#9;((s dotProduct: (sides at: i + 1 ifAbsent: [sides first])) closeTo: 0) &#13;&#9;&#9;&#9;ifFalse: [ ^ false]].&#13;&#9;^ true! !&#13;&#13;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:47'!&#13;isRectangle&#13;&#9;| diag1 diag2 points mid1 mid2|&#13;&#9;&#9;points := self arg1 points.&#13;&#9;diag1 := points first - points third.&#13;&#9;mid1 := points first + points third / 2.&#13;&#9;diag2 := points second - points fourth.&#13;&#9;mid2 := points second + points fourth / 2.&#13;&#9;^ self isQuad and: [diag1 r = diag2 r and: [mid1 = mid2]]&#13;! !&#13;&#13;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 4/29/2015 09:17'!&#13;isQuad&#13;&#9;^ self arg1 points size = 4! !&#13;&#13;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:36'!&#13;isOppositeSideParallel&#13;&#9;| side1 side2 side3 side4 points|&#13;&#9;points := self arg1 points.&#13;&#9;side1 := points first - points second.&#13;&#9;side2 := points second - points third.&#13;&#9;side3 := points third - points fourth.&#13;&#9;side4 := points fourth - points first.&#13;&#13;&#9;^ ((side1 crossProduct: side3) closeTo: 0)  and: [(side2 crossProduct: side4) closeTo: 0]  &#13;! !&#13;&#13;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 22:02'!&#13;compute&#13;&#9;self paintRed.&#13;&#9;^ self isRectangle &#13;&#9;&#9;ifTrue: [ &#13;&#9;&#9;&#9;self paintBlue.&#13;&#9;&#9;&#9;'Bravo !! Je suis un rectangle.' ]&#13;&#9;&#9;ifFalse: [  | message |&#13;&#9;&#9;&#9;message := ReadWriteStream on: String new.&#13;&#9;&#9;&#9;message &lt;&lt; 'Voyons, je ne suis pas un rectangle car :'.&#13;&#9;&#9;&#9;self isQuad &#13;&#9;&#9;&#9;&#9;ifFalse: [ message crtab &lt;&lt; '- je n''ai pas 4 sommets']&#13;&#9;&#9;&#9;&#9;ifTrue: [ &#13;&#9;&#9;&#9;&#9;&#9;self isOppositeSideIsometric ifFalse: [message crtab &lt;&lt; '- mes côtés opposés ne sont pas isométriques'].&#13;&#9;&#9;&#9;&#9;&#9;self isOppositeSideParallel ifFalse: [ message crtab &lt;&lt; '- mes côtés opposés ne sont pas parallèles' ].&#13;&#9;&#9;&#9;&#9;&#9;self isRectangleAngle ifFalse: [message crtab &lt;&lt; '- mes sommets ne sont pas droits']].&#13;&#9;&#9;&#9;&#9;message contents]&#13;! !&#13;&#13;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 4/29/2015 09:30'!&#13;paintRed&#13;&#9;self costume1 style color: Color red! !&#13;&#13;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 4/29/2015 09:30'!&#13;paintBlue&#13;&#9;self costume1 style color: Color blue! !&#13;&#13;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:35'!&#13;isOppositeSideIsometric&#13;&#9;| side1 side2 side3 side4 points|&#13;&#9;points := self arg1 points.&#13;&#9;side1 := points first - points second.&#13;&#9;side2 := points second - points third.&#13;&#9;side3 := points third - points fourth.&#13;&#9;side4 := points fourth - points first.&#13;&#13;&#9;^ side1 r = side3 r and: [side2 r = side4 r]  &#13;! !&#13;&#13;&quot;-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- &quot;!&#13;&#13;DrGeoScriptRectangle class&#13;&#9;instanceVariableNames: ''!&#13;&#13;!DrGeoScriptRectangle class methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:22'!&#13;description&#13;&#9;^'Je vérifie si un quadrilatère est un rectangle.&#13;Pour m''utiliser :&#13;1. Clique sur un polygone ;&#13;2. Clique quelque part sur le fond de la figure.&#13;Je colorie en bleu le quadrilatère lorsque c''est un rectangle, sinon j''indique ce qui ne va pas.'! !&#13;&#13;!DrGeoScriptRectangle class methodsFor: 'public' stamp: 'DrGeoUser 4/29/2015 09:29'!&#13;scriptName&#13;&#9;^'Est rectangle ?'! !&#13;&#13;&#13;!DrGeoScriptRectangle class methodsFor: 'private' stamp: 'DrGeoUser 4/29/2015 09:16'!&#13;newArgumentsType&#13;&#9;^{DrGPolygonItem}! !&#13;</code><x>-63.625000000000014</x><y>37.537500000000016</y></value></drgeo></drgenius>